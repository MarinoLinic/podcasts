<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>{{ page.title }}</title>
		<link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}" />
		<!-- Google Fonts for typography -->
		<link
			href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=JetBrains+Mono&display=swap"
			rel="stylesheet"
		/>
	</head>
	<body>
		<div class="container">
			<!-- Sidebar / Navigation -->
			<aside class="sidebar">
				<header>
					<h1><a href="{{ '/' | relative_url }}">{{ site.title }}</a></h1>
					<p class="subtitle">Library</p>
				</header>
				<nav>
					<ul>
						<!-- Loop through all files in Notes folder -->
						{% for note in site.pages %} {% if note.path contains 'Notes/' %}
						<li>
							<a href="{{ note.url | relative_url }}" class="{% if note.url == page.url %}active{% endif %}">
								{{ note.name | replace: '.md', '' }}
							</a>
						</li>
						{% endif %} {% endfor %}
					</ul>
				</nav>
			</aside>

			<!-- Main Content Area -->
			<main class="content">
				{% if page.path contains 'Notes/' %}
				<article class="markdown-body">
					<h1>{{ page.name | replace: '.md', '' }}</h1>
					<div class="note-content">{{ content }}</div>
				</article>

				<!-- Transcript Section -->
				<section class="transcript-section">
					<hr />
					<details id="transcript-container">
						<summary>ðŸ“„ View Transcript</summary>
						<div class="transcript-content">
							<pre id="transcript-text">Loading transcript...</pre>
						</div>
					</details>
				</section>

				<script>
					// Logic to find the matching transcript
					document.addEventListener('DOMContentLoaded', function () {
						const noteFilename = '{{ page.name }}'
						// Replace .md extension with .txt
						const transcriptFilename = noteFilename.replace('.md', '.txt')
						// Construct path (GitHub Pages serves relative to root)
						const transcriptPath = "{{ '/Transcripts/' | relative_url }}" + transcriptFilename

						fetch(transcriptPath)
							.then((response) => {
								if (!response.ok) throw new Error('Transcript not found')
								return response.text()
							})
							.then((text) => {
								document.getElementById('transcript-text').textContent = text
							})
							.catch((err) => {
								document.getElementById('transcript-text').textContent =
									'No matching transcript found in /Transcripts/ folder.'
							})
					})
				</script>
				{% else %}
				<!-- This handles the Index page content -->
				{{ content }} {% endif %}
			</main>
		</div>
	</body>
</html>
